cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T)
l
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values)
obj_longer %>%
group_by(Category, SuperPathway, MorphologicCondition, g) %>%
summarise(mean = mean(RA), total = sum(RA)) -> dataViz
dataViz %>%
# arrange(desc(Category)) %>%
mutate(SuperPathway = factor(SuperPathway,
levels = unique(SuperPathway))) -> dataViz
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values)
dataViz
dataViz %>%
mutate(SuperPathway = fct_reorder(Category, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values)
dataViz
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
obj_longer %>%
group_by(Category, SuperPathway, MorphologicCondition, g) %>%
summarise(mean = mean(RA), total = sum(RA)) -> dataViz
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz
?geom_col
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col(position_stack(reverse = TRUE)) +
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col(position_stack(reverse = TRUE))
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_bar() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(Category))) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>% summarise(mean = mean(RA), total = sum(RA))
dataViz
dataViz %>% summarise(total = sum(RA))
dataViz %>% summarise(total = sum(mean))
dataViz %>% summarise(total = sum(mean)) %>% arrange(SuperPathway)
dataViz %>% summarise(total = sum(mean)) %>% arrange(total)
dataViz %>% summarise(total = sum(mean)) %>% arrange(total) %>% distinct(SuperPathway)
dataViz %>% summarise(total = sum(mean)) %>%
arrange(desc(total))
dataViz %>% summarise(total = sum(mean)) %>%
arrange(desc(total)) %>% distinct(SuperPathway) %>% pull(SuperPathway)
dataViz %>% summarise(total = sum(mean))
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category) %>%
arrange(desc(total))
?fct_reorder
?group_split()
dataViz %>% summarise(total = sum(mean)) %>%
group_split(Category) %>%
arrange(desc(total))
dataViz %>% summarise(total = sum(mean)) %>%
group_split(Category)
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>% # Species, Sepal.Width, .desc = TRUE)
mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>% # Species, Sepal.Width, .desc = TRUE)
mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE))
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = fct_reorder2(Category, mean, .desc = TRUE))) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE))
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = fct_reorder2(Category, mean, .desc = TRUE))) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip()
?fct_reorder2
dataViz %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = fct_reorder(Category, mean, .desc = TRUE))) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
dataViz %>% summarise(total = sum(mean)) %>%
group_gy(Category) %>%
arrange(desc(total)) %>% distinct(SuperPathway) %>% pull(SuperPathway)
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category)
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category) %>%
arrange(desc(total))
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category) %>%
arrange(desc(total)) %>% distinct(SuperPathway) %>% pull(SuperPathway)
# dataViz %>%
# dataViz %>%
#   # arrange(desc(Category)) %>%
#   mutate(SuperPathway = factor(SuperPathway,
dataViz %>%
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean)))
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean)))
geom_col() + # position_stack(reverse = TRUE)
)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') # -> barPlot
cols <- unique(dataViz$Category)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values)
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 18, height = 10)
barPlot + scale_fill_manual("", values=values) -> barPlot
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 18, height = 10)
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 10, height = 10)
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 12, height = 10)
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 13, height = 10)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(col = guide_legend(ncol = 2)) -> barPlot
barPlot
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 16) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(fill = guide_legend(ncol = 2)) -> barPlot
barPlot
library(NatParksPalettes)
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values) -> barPlot
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 13, height = 10)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 18) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(fill = guide_legend(ncol = 2)) -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values) -> barPlot
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 13, height = 10)
dataViz %>%
mutate(SuperPathway = fct_reorder(SuperPathway, desc(mean))) %>%
# mutate(SuperPathway = fct_reorder(SuperPathway, .desc = TRUE)) %>%
ggplot(aes(x = SuperPathway, y = mean, fill = Category)) +
geom_col() + # position_stack(reverse = TRUE)
labs(y = "Relative Abudance of predicted gene (mean %)") +
coord_flip() +
# facet_grid(~  g + MorphologicCondition) +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(fill = guide_legend(ncol = 2)) -> barPlot
cols <- unique(dataViz$Category)
library(NatParksPalettes)
values <- natparks.pals("Yellowstone", length(cols), direction = 1) # "Yellowstone"
barPlot + scale_fill_manual("", values=values) -> barPlot
ggsave(barPlot, filename = "barKegg.png", path = dir, width = 13, height = 10)
dataViz
obj_longer
obj_longer %>%
ggplot(aes(x = SampleID, SuperPathway)) + geom_raster() +
)
obj_longer %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = RA)) + geom_raster() +
)
obj_longer %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = RA)) +
geom_raster()
obj_longer
obj_longer %>%
group_by(Category, SuperPathway, MorphologicCondition, g) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster()
obj_longer %>%
group_by(Category, MorphologicCondition, g) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster()
obj_longer %>%
group_by(MorphologicCondition, g) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster()
obj_longer %>%
group_by(MorphologicCondition, g)
obj_longer %>%
group_by(SampleID) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster()
obj_longer %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster()
obj_longer %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T) +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(fill = guide_legend(ncol = 2))
obj_longer %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(fill = guide_legend(ncol = 2))
obj_longer %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top') +
guides(fill = guide_legend(ncol = 1))
obj_longer %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top')
obj_longer %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = RA)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top')
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category) %>%
arrange(desc(total)) %>% distinct(SuperPathway) %>% pull(SuperPathway)
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category) %>%
arrange(desc(total)) %>% distinct(SuperPathway) %>% pull(SuperPathway) -> CategoryL
dataViz %>% summarise(total = sum(mean)) %>%
group_by(Category) %>%
arrange(desc(total)) %>% distinct(SuperPathway) %>% pull(SuperPathway) -> SuperPathwayL
obj_longer %>%
mutate(SuperPathway = factor(SuperPathway, levels = SuperPathwayL)) %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = RA)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top')
obj_longer %>%
mutate(SuperPathway = factor(SuperPathway, levels = SuperPathwayL)) %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_bw(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top')
obj_longer %>%
mutate(SuperPathway = factor(SuperPathway, levels = SuperPathwayL)) %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_classic(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), legend.position = 'top')
obj_longer %>%
mutate(SuperPathway = factor(SuperPathway, levels = SuperPathwayL)) %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_classic(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), axis.ticks.length.x = element_blank(), legend.position = 'top')
obj_longer %>%
mutate(SuperPathway = factor(SuperPathway, levels = SuperPathwayL)) %>%
group_by(SampleID, Category) %>%
mutate(Pct = RA/sum(RA)) %>%
ggplot(aes(x = SampleID, y = SuperPathway, fill = Pct)) +
geom_raster() +
ggh4x::facet_nested(~  g + MorphologicCondition, nest_line = T, scales = 'free') +
theme_classic(base_size = 17) +
theme(strip.background = element_rect(fill = 'white', color = 'white'),
panel.border = element_blank(), axis.ticks.x = element_blank(), legend.position = 'top')
